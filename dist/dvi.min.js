var DVI=(function(){var b=function(e){if(typeof Array.prototype.indexOf==="function"){b=Array.prototype.indexOf}else{b=function(h){var g=-1,f=-1;for(g=0;g<this.length;g++){if(this[g]===h){f=g;break}}return f}}return b.call(this,e)};var a=function(e,f,g){if(g!==undefined&&g!==null){this.data=g;this.current="yes"}else{this.data={};this.current="no"}this.set_func=e;this.args=(f||[]);this.callback=[];this.views={}};a.prototype={set:function(j){try{var g=this;function f(e){if(e!==undefined&&e!==null){g.data=e;g.current="yes"}else{throw new Error("No response from server.")}if(j!=="silent"){g.loadCallback()}}var k=[];for(var h=0;h<this.args.length;h++){k.push(this.args[h])}k.push(f);this.set_func.apply(null,k)}catch(l){console.log("Data setting error: "+l.message)}},update:function(e){this.current="pending";if(e&&typeof e==="function"){this.callback.push(e)}this.set()},silentUpdate:function(){this.current="pending";this.set("silent")},get:function(e){if(this.current=="yes"){e(this.data)}else{if(this.current=="pending"){this.callback.push(e)}else{this.update(e)}}},change:function(e,f){this.set_func=(e||this.set_func);this.args=(f||this.args);this.update()},addView:function(f,e){this.views[f]=e;if(this.current=="yes"){e(this.data)}else{if(this.current=="pending"){}else{this.update()}}},hasView:function(e){return this.views.hasOwnProperty(e)},removeView:function(e){delete this.views[e]},clearViews:function(){this.views={}},loadCallback:function(){if(this.current=="yes"){for(var f in this.views){if(this.views.hasOwnProperty(f)){try{this.views[f](this.data)}catch(h){console.log("Error updating view: "+h.message)}}}for(var g=0;g<this.callback.length;g++){try{this.callback[g](this.data)}catch(h){console.log("Error with callback function: "+h.message)}}this.callback=[]}else{console.log("Error updating data: "+self.data)}}};var d=function(e,g,f){this.name=e;this.update=g;this.Data={};if(f){this.attach(f)}};d.prototype={attach:function(f){try{f.addView(this.name,this.update);this.Data=f}catch(g){console.log("Error attaching Data object: "+g.message)}},detach:function(){try{this.Data.removeView(this.name)}catch(f){console.log("Error detaching Data object: "+f.message)}this.Data={}},load:function(e,f){if(e!==undefined&&e!==null){this.update(e);if(typeof f==="function"){f(e)}}else{if(this.Data!==undefined&&this.Data.update!==undefined){this.Data.update(f)}else{console.log("Error updating "+this.name+" view. No Data.")}}},reload:function(e){this.load(null,e)}};var c=function(f,g,e,h){this.id="dvi_"+(new Date().getTime());this.input=f;this.Data={};this.format=function(){};this.handler=function(){};if(e!==undefined&&e!==null){this.format_func=e}else{this.format_func=function(i){return i}}if(g){h=h||false;this.attach(g,this.format_func,h)}};c.prototype={attach:function(f,e,h){this.format=e||this.format_func;h=h||false;var i=this;this.handler=function(){var j=i.value();if(j instanceof Array){f.change(null,j)}else{f.change(null,[j])}};if(typeof $!=="undefined"&&typeof $.fn.change==="function"){$(this.input).bind("change."+this.id,function(){var k=null;var j=$(this).prop("type");if(j=="radio"||j=="checkbox"){k=$(i.input).filter(":checked").val()}else{k=$(this).val()}if(!$.isArray(k)){k=[k]}f.change(null,i.format(k))});if(h==true){$(this.input).trigger("change."+this.id)}}else{console.log("DVI: jQuery not found.");function g(l,k,j){if(typeof l.addEventListener==="function"){l.addEventListener(k,j,false)}else{l.attachEvent("on"+k,j)}}if(b.call(this.clicks,this.findType(this.input))>0){g(this.input,"click",this.handler)}else{g(this.input,"keyup",this.handler)}if(h==true){f.change(null,i.value())}}},detach:function(e){if(typeof $!=="undefined"&&typeof $.fn.change==="function"){$(this.input).unbind("change."+this.id)}else{function f(i,h,g){if(typeof i.removeEventListener==="function"){i.removeEventListener(h,g,false)}else{i.detachEvent("on"+h,g)}}if(b.call(this.clicks,this.findType(this.input))>0){f(this.input,"click",this.handler)}else{f(this.input,"keyup",this.handler)}}},clicks:["radio","checkbox","select-one","select-multiple"],value:function(){return this.format(this.getValue(this.input))},getValue:function(f){var h=undefined;switch(this.findType(f)){case"text":h=f.value;break;case"hidden":h=f.value;break;case"password":h=f.value;break;case"textarea":h=f.value;break;case"select-one":h=f.options[f.selectedIndex].value;break;case"select-multiple":var g=new Array();for(var e=0;e<f.options.length;e++){if(f.options[e].selected){g.push(f.options[e].value)}}h=g;break;case"radio":var g=new Array();for(var e=0;e<f.length;e++){if(f[e].checked){g.push(f[e].value)}}h=g;break;case"checkbox":var g=new Array();for(var e=0;e<f.length;e++){if(f[e].checked){g.push(f[e].value)}}h=g;break;default:h=f.value;break}return h},findType:function(e){if(e.length!==undefined){if(e.type!==undefined){return e.type}else{e=e[0]}}var f=e.tagName.toLowerCase();if(f="input"){return e.type.toLowerCase()}else{return f}}};return{data:a,view:d,interact:c}})();